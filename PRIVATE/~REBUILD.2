@echo off
rem This tool will generate two unlinked cab chains that will be used with the LAYOUT.INF

rmdir /S /Q PRODUCTION
mkdir PRODUCTION

cd WORKSPACE

del DIRECTIVES_GENERATED.DDF
del DIRECTIVES_GENERATEDMINI.DDF
del DIRECTIVES_GENERATEDWFIL.DDF
del DIRECTIVES_GENERATEDPREC.DDF
del SETUP.INF
del SETUP.RPT

copy ..\PRIVATE\DIRECTIVES_MAIN.DDF DIRECTIVES_GENERATEDPREC.DDF
copy ..\PRIVATE\DIRECTIVES_MAIN.DDF DIRECTIVES_GENERATEDWFIL.DDF
copy ..\PRIVATE\DIRECTIVES_MINI.DDF DIRECTIVES_GENERATEDMINI.DDF

rem MINI.CAB

cd MINI

mkdir "..\..\PRODUCTION\MINI_CABS"
xcopy "..\..\EXTRACTED\WIN95\*.*" "..\..\PRODUCTION\MINI_CABS"
del /Q "..\..\PRODUCTION\MINI_CABS\*.cab"

echo .Set DiskDirectoryTemplate="..\PRODUCTION\MINI_CABS" >> ..\DIRECTIVES_GENERATEDMINI.DDF
echo .Set CabinetNameTemplate="MINI.CAB" >> ..\DIRECTIVES_GENERATEDMINI.DDF
cscript /Nologo ..\..\PRIVATE\SPECIAL_DIR.VBS . "MINI\" >> ..\DIRECTIVES_GENERATEDMINI.DDF
cd ..

rem PRECOPY.CAB

cd PRECOPY

echo .Set DiskDirectoryTemplate="..\PRODUCTION\WIN95" >> ..\DIRECTIVES_GENERATEDPREC.DDF
echo .Set CabinetNameTemplate="PRECOPY*.CAB" >> ..\DIRECTIVES_GENERATEDPREC.DDF
echo .New Cabinet >> ..\DIRECTIVES_GENERATEDPREC.DDF
cscript /Nologo ..\..\PRIVATE\SPECIAL_DIR.VBS . "PRECOPY\" >> ..\DIRECTIVES_GENERATEDPREC.DDF
cd ..

..\MAKECAB\makecab /F DIRECTIVES_GENERATEDMINI.DDF

rem echo "LAYOUT.INF" >> DIRECTIVES_GENERATEDPREC.DDF

echo .Set Compress=OFF >> DIRECTIVES_GENERATEDPREC.DDF
echo .Set Cabinet=OFF >> DIRECTIVES_GENERATEDPREC.DDF


cscript /Nologo ..\PRIVATE\SPECIAL_DIR.VBS "..\PRODUCTION\MINI_CABS\" "..\PRODUCTION\MINI_CABS\" >> DIRECTIVES_GENERATEDPREC.DDF


echo .Set Compress=ON >> DIRECTIVES_GENERATEDPREC.DDF
echo .Set Cabinet=ON >> DIRECTIVES_GENERATEDPREC.DDF

rem WIN95.CAB

cd WIN95
echo .Set MaxDiskSize=2048000 >> ..\DIRECTIVES_GENERATEDWFIL.DDF
echo .Set DiskDirectoryTemplate="..\PRODUCTION\WIN95" >> ..\DIRECTIVES_GENERATEDWFIL.DDF
echo .Set CabinetNameTemplate="WIN95_*.CAB" >> ..\DIRECTIVES_GENERATEDWFIL.DDF
echo .New Cabinet >> ..\DIRECTIVES_GENERATEDWFIL.DDF
cscript /Nologo ..\..\PRIVATE\SPECIAL_DIR.VBS . "WIN95\" >> ..\DIRECTIVES_GENERATEDWFIL.DDF
cd ..

..\MAKECAB\makecab /F DIRECTIVES_GENERATEDPREC.DDF
..\MAKECAB\makecab /F DIRECTIVES_GENERATEDWFIL.DDF

rmdir /S /Q ..\PRODUCTION\MINI_CABS

xcopy /E CDADD ..\PRODUCTION

del SETUP.INF
del SETUP.RPT

cd ..
